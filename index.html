<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Valentine</title>

  <style>
    :root{
      --bg:#ffd1e6;
      --bg2:#ffe7f1;
      --env:#ff4fa3;
      --env-dark:#e63a8d;
      --flap:#ff77bf;
      --paper:#fff6fb;
      --ink:#8a2b5b;
      --stroke:#2f63ff;
      --shadow:rgba(0,0,0,.15);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      background: radial-gradient(1200px 700px at 50% 20%, var(--bg2), var(--bg));
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      overflow-x:hidden;
      color:#1d1d1d;
    }

    .wrap{
      width:min(980px, 92vw);
      padding:32px 20px 28px;
      text-align:center;
      position:relative;
    }

    /* ---------- SIDE LAYOUT (pictures live next to envelope) ---------- */
    .scene{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:60px;
      position:relative;
    }

    .gallery{
      display:flex;
      flex-direction:column;
      gap:18px;
      width:160px;
    }
    .gallery.right{ align-items:flex-start; }
    .gallery.left{ align-items:flex-end; }

    .gallery img{
      width:150px;
      height:190px;
      object-fit:cover;
      border-radius:18px;
      background:#fff;
      box-shadow:0 18px 35px rgba(0,0,0,.16);
      border:6px solid rgba(255,255,255,.75);
    }
    .gallery img:nth-child(1){ transform:rotate(-6deg); }
    .gallery img:nth-child(2){ transform:rotate(5deg); }
    .gallery img:nth-child(3){ transform:rotate(-4deg); }

    .hidden{ display:none !important; }

    /* ---------- ENVELOPE AREA ---------- */
    .envelope-wrapper{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:14px;
      position:relative;
      z-index:5;
    }

    .stage{
      position:relative;
      width:360px;   /* bigger envelope */
      height:290px;
      display:grid;
      place-items:center;
      margin:0 auto 8px;
      filter: drop-shadow(0 28px 30px rgba(0,0,0,.18));
    }

    .envelope{
      position:relative;
      width:340px;
      height:230px;
      border-radius:26px;
      background: linear-gradient(180deg, var(--env), var(--env-dark));
      overflow:visible;
      z-index:5;
    }

    /* bottom inside triangle */
    .envelope::before{
      content:"";
      position:absolute;
      inset:auto 0 0 0;
      margin:auto;
      width:0;height:0;
      border-left:170px solid transparent;
      border-right:170px solid transparent;
      border-top:120px solid rgba(255,255,255,.08);
      opacity:.7;
      z-index:1;
    }

    /* flap: opens upward correctly */
    .flap{
      position:absolute;
      left:50%;
      top:-2px;
      width:0;height:0;
      transform: translateX(-50%) rotate(0deg);
      transform-origin: 50% 100%;   /* hinge at bottom */
      border-left:170px solid transparent;
      border-right:170px solid transparent;
      border-top:130px solid var(--flap);
      z-index:9;
      transition: transform 850ms cubic-bezier(.2,.9,.2,1);
      filter: drop-shadow(0 12px 14px rgba(0,0,0,.12));
    }

    .envelope.open .flap{
      transform: translateX(-50%) rotate(-180deg);
    }

    /* letter card */
    .letter{
      position:absolute;
      top:18px;
      left:50%;
      transform:translateX(-50%);
      width:280px;
      min-height:140px;
      padding:18px 18px 16px;
      background: var(--paper);
      border-radius:18px;
      border:4px solid var(--stroke);
      box-shadow: 0 18px 35px rgba(0,0,0,.14);
      z-index:12; /* stays in front of flap */
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:14px;
      transition: transform 800ms cubic-bezier(.2,.9,.2,1), opacity 300ms ease;
      opacity:0;
      pointer-events:none;
    }

    .letter.show{
      opacity:1;
      pointer-events:auto;
      transform:translateX(-50%) translateY(-70px);
    }

    .letter h2{
      margin:0;
      color:var(--ink);
      font-size:34px;
      line-height:1.05;
      font-weight:800;
      letter-spacing:-.5px;
    }

    .choices{
      display:flex;
      justify-content:center;
      gap:12px;
      margin-top:2px;
      position:relative;
      height:48px;
    }

    .btn{
      border:none;
      border-radius:999px;
      padding:12px 20px;
      font-weight:800;
      cursor:pointer;
      font-size:16px;
      transition: transform .12s ease, filter .12s ease;
      user-select:none;
    }

    .btn:active{ transform:scale(.98); }
    .btn:hover{ filter:brightness(.98); }

    .btn-accept{
      background:#ff4da6;
      color:#fff;
      box-shadow:0 12px 22px rgba(255,77,166,.35);
    }

    .btn-reject{
      background:#ffd3e6;
      color:#8a2b5b;
      border:2px solid rgba(138,43,91,.18);
      position:relative;
    }

    /* below envelope: hint + input */
    .hint{
      margin:8px auto 10px;
      max-width:560px;
      font-size:18px;
      line-height:1.25;
    }
    .hint em{ font-style:italic; }

    .code-row{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
      margin:10px auto 12px;
      flex-wrap:wrap;
    }

    #codeInput{
      width:min(380px, 78vw);
      padding:14px 16px;
      border-radius:14px;
      border:2px solid #ffa3cd;
      outline:none;
      font-size:16px;
      background:#fff;
    }

    .unlock{
      padding:14px 22px;
      border-radius:14px;
      border:none;
      background:#ff4da6;
      color:#fff;
      font-weight:800;
      cursor:pointer;
      box-shadow:0 12px 22px rgba(255,77,166,.25);
    }

    .reset{
      margin-top:18px;
      padding:12px 26px;
      border-radius:999px;
      border:2px solid #ffd1e6;
      background:#fff3fa;
      color:#8a2b5b;
      font-weight:800;
      cursor:pointer;
      box-shadow:0 12px 22px rgba(0,0,0,.08);
    }

    .shake{
      animation:shake .35s ease;
    }
    @keyframes shake{
      0%{ transform:translateX(0); }
      25%{ transform:translateX(-6px); }
      50%{ transform:translateX(6px); }
      75%{ transform:translateX(-4px); }
      100%{ transform:translateX(0); }
    }

    /* confetti items */
    .float-layer{
      position:absolute;
      inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index:2;
    }

    .heart, .ball{
      position:absolute;
      font-size:22px;
      opacity:0;
      animation:pop 1.2s ease forwards;
      will-change: transform, opacity;
    }

    .ball{
      width:18px;height:18px;
      border-radius:50%;
      background:#d9ff4d;
      box-shadow: inset -3px -3px 0 rgba(0,0,0,.10);
    }

    @keyframes pop{
      0%{ transform:translate(var(--x0), var(--y0)) scale(.7); opacity:0; }
      12%{ opacity:1; }
      100%{ transform:translate(var(--x1), var(--y1)) scale(1); opacity:0; }
    }

    /* Responsive: move galleries under on small screens */
    @media (max-width: 880px){
      .scene{ flex-direction:column; gap:22px; }
      .gallery{ flex-direction:row; width:auto; }
      .gallery.left, .gallery.right{ align-items:center; }
      .gallery img{ width:120px; height:150px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="scene">

      <!-- LEFT pictures -->
      <div id="galleryLeft" class="gallery left hidden"></div>

      <!-- CENTER envelope -->
      <div class="envelope-wrapper">
        <div class="stage">
          <div class="float-layer" id="floatLayer"></div>

          <div class="envelope" id="envelope">
            <div class="flap"></div>

            <div class="letter" id="letter">
              <h2 id="letterText">congratulations! you<br>have won a certificate<br>for 1000 kissesüíã</h2>

              <div class="choices">
                <button class="btn btn-accept" id="acceptBtn" type="button">Accept</button>
                <button class="btn btn-reject" id="rejectBtn" type="button">Reject</button>
              </div>
            </div>
          </div>
        </div>

        <div class="hint">
          ‚Äúi am <em>sinkingggg</em>.. u should know the code.<br>
          Hint: it's a cute nickname but you'd think i'm a sarcastic grandma if i say it, 10 letters‚Äù
        </div>

        <div class="code-row" id="codeRow">
          <!-- visible typing (text, not password) -->
          <input id="codeInput" type="text" placeholder="type the code here‚Ä¶" autocomplete="off" />
          <button class="unlock" id="unlockBtn" type="button">Unlock</button>
        </div>

        <button class="reset" id="resetBtn" type="button">Reset</button>
      </div>

      <!-- RIGHT pictures -->
      <div id="galleryRight" class="gallery right hidden"></div>

    </div>
  </div>

  <script>
    const CODE = "sweetheart";

    const envelope = document.getElementById("envelope");
    const letter = document.getElementById("letter");
    const letterText = document.getElementById("letterText");

    const acceptBtn = document.getElementById("acceptBtn");
    const rejectBtn = document.getElementById("rejectBtn");

    const codeInput = document.getElementById("codeInput");
    const unlockBtn = document.getElementById("unlockBtn");
    const resetBtn = document.getElementById("resetBtn");
    const codeRow = document.getElementById("codeRow");

    const floatLayer = document.getElementById("floatLayer");

    const left = document.getElementById("galleryLeft");
    const right = document.getElementById("galleryRight");

    let unlocked = false;
    let state = "locked"; // locked | opened | accepted | rejectedMessage
    let dodgeCount = 0;   // makes Reject annoying but still clickable

    function spawnBurst(countHearts=20, countBalls=14){
      const rect = envelope.getBoundingClientRect();
      const originX = rect.left + rect.width/2;
      const originY = rect.top + 45;

      for(let i=0;i<countHearts;i++){
        const el = document.createElement("div");
        el.className = "heart";
        el.textContent = "üíó";
        const x0 = originX + rand(-10,10);
        const y0 = originY + rand(-10,10);
        const x1 = originX + rand(-220,220);
        const y1 = originY + rand(120, 360);

        el.style.left = (x0) + "px";
        el.style.top  = (y0) + "px";
        el.style.setProperty("--x0","0px");
        el.style.setProperty("--y0","0px");
        el.style.setProperty("--x1",(x1-x0)+"px");
        el.style.setProperty("--y1",(y1-y0)+"px");
        el.style.animationDuration = rand(900,1400) + "ms";

        floatLayer.appendChild(el);
        setTimeout(()=>el.remove(), 1600);
      }

      for(let i=0;i<countBalls;i++){
        const el = document.createElement("div");
        el.className = "ball";
        const x0 = originX + rand(-10,10);
        const y0 = originY + rand(-10,10);
        const x1 = originX + rand(-260,260);
        const y1 = originY + rand(160, 420);

        el.style.left = (x0) + "px";
        el.style.top  = (y0) + "px";
        el.style.setProperty("--x0","0px");
        el.style.setProperty("--y0","0px");
        el.style.setProperty("--x1",(x1-x0)+"px");
        el.style.setProperty("--y1",(y1-y0)+"px");
        el.style.animationDuration = rand(950,1500) + "ms";

        floatLayer.appendChild(el);
        setTimeout(()=>el.remove(), 1700);
      }
    }

    function rand(min,max){
      return Math.floor(Math.random()*(max-min+1))+min;
    }

    function openEnvelope(){
      envelope.classList.add("open");
      letter.classList.add("show");
      spawnBurst(18, 10);
      state = "opened";
    }

    function hideGalleries(){
      left.classList.add("hidden");
      right.classList.add("hidden");
      left.innerHTML = "";
      right.innerHTML = "";
    }

    function showGalleries(){
      left.innerHTML = `
        <img src="assets/p1.jpg" alt="pic 1">
        <img src="assets/p2.jpg" alt="pic 2">
      `;
      right.innerHTML = `
        <img src="assets/p3.jpg" alt="pic 3">
        <img src="assets/p4.jpg" alt="pic 4">
        <img src="assets/p5.jpg" alt="pic 5">
      `;
      left.classList.remove("hidden");
      right.classList.remove("hidden");
    }

    function resetAll(){
      unlocked = false;
      state = "locked";
      dodgeCount = 0;

      envelope.classList.remove("open");
      letter.classList.remove("show");
      letterText.innerHTML = "congratulations! you<br>have won a certificate<br>for 1000 kissesüíã";

      codeInput.value = "";
      codeRow.classList.remove("hidden");

      acceptBtn.classList.remove("hidden");
      rejectBtn.classList.remove("hidden");
      rejectBtn.style.transform = "";
      rejectBtn.style.left = "";
      rejectBtn.style.top = "";
      rejectBtn.style.position = "relative";

      hideGalleries();
    }

    function wrongCode(){
      codeRow.classList.add("shake");
      setTimeout(()=>codeRow.classList.remove("shake"), 380);
    }

    unlockBtn.addEventListener("click", () => {
      const v = (codeInput.value || "").trim().toLowerCase();

      if(v === CODE){
        unlocked = true;
        codeRow.classList.add("hidden"); // hide input after unlock
        openEnvelope();
      }else{
        wrongCode();
      }
    });

    codeInput.addEventListener("keydown", (e) => {
      if(e.key === "Enter") unlockBtn.click();
    });

    acceptBtn.addEventListener("click", () => {
      if(!unlocked) return;

      letterText.innerHTML = "yayyy, contact your gf<br>for activation :)<br>happy valentines ü´∂";
      spawnBurst(26, 18);
      showGalleries();
      state = "accepted";
    });

    // Reject button: dodges a few times, then becomes clickable
    rejectBtn.addEventListener("mouseenter", () => {
      if(!unlocked) return;
      if(state !== "opened") return;
      if(dodgeCount >= 4) return;
      if(Math.random() < 0.25) return;

      dodgeCount++;

      const bounds = letter.getBoundingClientRect();
      const maxX = Math.max(0, bounds.width - rejectBtn.offsetWidth - 20);
      const maxY = 40;

      rejectBtn.style.position = "absolute";
      rejectBtn.style.left = rand(10, maxX) + "px";
      rejectBtn.style.top  = rand(0, maxY) + "px";
    });

    // If he clicks Reject:
    rejectBtn.addEventListener("click", () => {
      if(!unlocked) return;

      letterText.innerHTML = "think again";
      spawnBurst(18, 10);
      showGalleries();
      state = "rejectedMessage";
    });

    resetBtn.addEventListener("click", resetAll);

    resetAll();
  </script>
</body>
</html>

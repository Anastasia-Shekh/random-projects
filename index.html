<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üíå</title>
  <style>
    :root{
      --bg1:#ffe8f2;
      --bg2:#f7c7d9;
      --ink:#7a2f4f;
      --hot:#ff4fa3;
      --hot2:#ff77ba;
      --blue:#2f63ff;
      --shadow: 0 22px 60px rgba(0,0,0,.20);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background: radial-gradient(circle, var(--bg1) 0%, var(--bg2) 100%);
      overflow-x:hidden;
      color:#222;
    }

    /* layout */
    .wrap{
      width:min(1100px, 92vw);
      margin:0 auto;
      min-height:100vh;
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      grid-template-areas: "left center right";
      align-items:center;
      gap: clamp(12px, 3vw, 28px);
      padding: clamp(14px, 3vw, 28px) 0;
    }
    .center-col{grid-area:center; display:flex; flex-direction:column; align-items:center; width:100%;}
    .photos-left{grid-area:left; display:flex; flex-direction:column; gap:16px; align-items:center;}
    .photos-right{grid-area:right; display:flex; flex-direction:column; gap:16px; align-items:center;}

    @media (max-width: 900px){
      .wrap{
        grid-template-columns:1fr;
        grid-template-areas:
          "center"
          "left"
          "right";
        justify-items:center;
      }
      .photos-left,.photos-right{
        flex-direction:row;
        flex-wrap:wrap;
        justify-content:center;
        gap:14px;
      }
    }

    /* envelope scales nicely */
    .envelope{
      width: clamp(280px, 42vw, 520px);
      height: clamp(190px, 30vw, 340px);
      position: relative;
      filter: drop-shadow(var(--shadow));
      margin: 0 auto;
    }
    .env-back{
      position:absolute; inset:0;
      border-radius: 26px;
      background: linear-gradient(135deg, #ff5cab 0%, #c81d6e 100%);
      overflow:hidden;
    }
    /* subtle folds */
    .env-back::before{
      content:"";
      position:absolute; inset:-40%;
      background:
        linear-gradient(45deg, rgba(255,255,255,.08) 0 40%, rgba(255,255,255,0) 40% 100%),
        linear-gradient(-45deg, rgba(255,255,255,.08) 0 40%, rgba(255,255,255,0) 40% 100%);
      transform: rotate(12deg);
      opacity:.8;
      pointer-events:none;
    }

    /* bottom flap */
    .env-bottom{
      position:absolute;
      left:0; right:0; bottom:0;
      height: 58%;
      clip-path: polygon(0 100%, 50% 20%, 100% 100%, 100% 100%, 0 100%);
      background: rgba(255,255,255,.08);
      pointer-events:none;
    }

    /* left/right folds */
    .env-left, .env-right{
      position:absolute;
      top: 38%;
      width: 58%;
      height: 62%;
      background: rgba(0,0,0,.08);
      pointer-events:none;
    }
    .env-left{
      left:0;
      clip-path: polygon(0 0, 100% 50%, 0 100%);
      background: rgba(255,255,255,.10);
    }
    .env-right{
      right:0;
      clip-path: polygon(100% 0, 0 50%, 100% 100%);
      background: rgba(0,0,0,.06);
    }

    /* top flap that opens upward */
    .env-top{
      position:absolute;
      left: 0; right: 0;
      top: 0;
      height: 60%;
      background: linear-gradient(135deg, #ff7bc2 0%, #ff4fa3 100%);
      clip-path: polygon(0 0, 100% 0, 50% 92%);
      transform-origin: 50% 0%;
      transform: rotateX(0deg);
      transition: transform 700ms cubic-bezier(.2,.8,.2,1);
      border-top-left-radius: 26px;
      border-top-right-radius: 26px;
      z-index: 5;
    }
    .envelope.open .env-top{
      transform: rotateX(180deg);
    }

    /* letter */
    .letter{
      position:absolute;
      left:50%;
      bottom: 16%;
      transform: translateX(-50%) translateY(30px);
      width: clamp(300px, 62vw, 720px);
      max-width: 100%;
      background: rgba(255,255,255,.85);
      border: 5px solid var(--blue);
      border-radius: 22px;
      padding: clamp(18px, 2.6vw, 28px);
      box-shadow: 0 18px 50px rgba(0,0,0,.18);
      text-align:center;
      opacity:0;
      pointer-events:none;
      transition: opacity 420ms ease, transform 650ms cubic-bezier(.2,.8,.2,1);
      z-index: 10;
    }
    .envelope.open .letter{
      opacity:1;
      transform: translateX(-50%) translateY(0px);
      pointer-events:auto;
    }
    .letter.wide{
      width: clamp(340px, 70vw, 820px);
    }

    .letter h1{
      margin:0 0 8px 0;
      font-size: clamp(28px, 4.2vw, 54px);
      line-height:1.05;
      color: var(--ink);
      font-weight: 800;
      letter-spacing: -0.5px;
      text-transform: lowercase;
    }
    .letter p{
      margin: 8px 0 0 0;
      font-size: clamp(16px, 2vw, 20px);
      color: var(--ink);
      font-weight: 600;
    }

    .btn-row{
      display:flex;
      gap: 14px;
      justify-content:center;
      margin-top: 18px;
    }
    .btn{
      border:none;
      cursor:pointer;
      padding: 12px 22px;
      border-radius: 999px;
      font-weight: 800;
      font-size: 18px;
      transition: transform .12s ease, box-shadow .12s ease;
      user-select:none;
    }
    .btn:active{ transform: translateY(1px) scale(.99); }
    .btn-accept{
      background: linear-gradient(135deg, var(--hot) 0%, var(--hot2) 100%);
      color:white;
      box-shadow: 0 10px 22px rgba(255,79,163,.35);
    }
    .btn-reject{
      background: rgba(255,255,255,.55);
      color: var(--ink);
      border: 3px solid var(--blue);
      box-shadow: 0 10px 22px rgba(47,99,255,.12);
      position: relative; /* we move it with translate */
    }

    /* hint + input area */
    .controls{
      margin-top: clamp(14px, 2.5vw, 20px);
      width: min(720px, 92vw);
      text-align:center;
    }
    .hint{
      font-size: clamp(16px, 2vw, 20px);
      line-height:1.35;
      color: #111;
    }
    .hint em{ font-style: italic; }
    .input-row{
      margin-top: 14px;
      display:flex;
      justify-content:center;
      gap: 14px;
      flex-wrap:wrap;
    }
    input[type="text"]{
      width: min(520px, 92vw);
      height: 58px;
      padding: 0 18px;
      border-radius: 18px;
      border: 3px solid rgba(255,79,163,.55);
      background: rgba(255,255,255,.55);
      font-size: 20px;
      outline:none;
      box-shadow: 0 16px 40px rgba(0,0,0,.10);
    }
    input[type="text"]:focus{
      border-color: var(--hot);
      background: rgba(255,255,255,.75);
    }
    .unlock{
      height: 58px;
      padding: 0 22px;
      border-radius: 18px;
      border:none;
      cursor:pointer;
      font-weight:900;
      font-size: 20px;
      background: linear-gradient(135deg, var(--hot) 0%, var(--hot2) 100%);
      color:white;
      box-shadow: 0 14px 30px rgba(255,79,163,.35);
    }
    .unlock:disabled{
      opacity:.55;
      cursor:not-allowed;
    }

    .reset{
      margin-top: 16px;
      height: 52px;
      padding: 0 26px;
      border-radius: 999px;
      border: 3px solid rgba(255,79,163,.25);
      background: rgba(255,255,255,.55);
      cursor:pointer;
      font-weight: 900;
      font-size: 18px;
      color: var(--ink);
      box-shadow: 0 14px 30px rgba(0,0,0,.08);
    }

    /* photos */
    .photo{
      width: clamp(170px, 18vw, 260px);
      aspect-ratio: 3 / 4;
      border-radius: 18px;
      border: 10px solid #fff;
      box-shadow: 0 18px 45px rgba(0,0,0,0.18);
      overflow:hidden;
      background:#fff;
      transform: rotate(var(--r, 0deg));
      opacity: 0;
      transform-origin:center;
      transition: opacity 350ms ease;
    }
    .photo.show{ opacity: 1; }
    .photo img{ width:100%; height:100%; object-fit:cover; display:block; }

    @media (max-width: 900px){
      .photo{ width: clamp(150px, 40vw, 230px); }
    }
    @media (max-width: 420px){
      .photo{ width: 86vw; max-width: 300px; }
    }

    /* confetti hearts/tennis */
    .confetti-layer{
      position: fixed;
      inset: 0;
      pointer-events:none;
      overflow:hidden;
      z-index: 999;
    }
    .confetti{
      position:absolute;
      top: -40px;
      font-size: 26px;
      animation: fall linear forwards;
      filter: drop-shadow(0 8px 10px rgba(0,0,0,.15));
      user-select:none;
    }
    @keyframes fall{
      to{
        transform: translateY(calc(100vh + 80px)) rotate(360deg);
        opacity: 0.95;
      }
    }

    /* hide section helper */
    .hidden{ display:none !important; }

    /* small message under input */
    .error{
      margin-top: 10px;
      font-weight: 800;
      color: #b1004f;
      min-height: 22px;
    }
  </style>
</head>

<body>
  <div class="confetti-layer" id="confettiLayer"></div>

  <div class="wrap">
    <div class="photos-left" id="photosLeft"></div>

    <div class="center-col">
      <div class="envelope" id="envelope">
        <div class="env-back"></div>
        <div class="env-left"></div>
        <div class="env-right"></div>
        <div class="env-bottom"></div>
        <div class="env-top"></div>

        <div class="letter" id="letter" aria-live="polite">
          <h1 id="letterTitle">congratulations!<br>you<br>have won a certificate<br>for 1000 kissesüíã</h1>

          <div class="btn-row" id="letterButtons">
            <button class="btn btn-accept" id="acceptBtn" type="button">Accept</button>
            <button class="btn btn-reject" id="rejectBtn" type="button">Reject</button>
          </div>
        </div>
      </div>

      <div class="controls" id="controls">
        <div class="hint" id="hint">
          ‚Äúi am <em>sinkinggg</em>.. u should know the code.<br>
          Hint: it's a cute nickname but you'd think i'm a sarcastic grandma if i say it, 10 letters‚Äù
        </div>

        <div class="input-row">
          <input id="codeInput" type="text" autocomplete="off" spellcheck="false" placeholder="type the code here‚Ä¶" />
          <button id="unlockBtn" class="unlock" type="button">Unlock</button>
        </div>

        <div class="error" id="errorText"></div>

        <button id="resetBtn" class="reset" type="button">Reset</button>
      </div>
    </div>

    <div class="photos-right" id="photosRight"></div>
  </div>

  <script>
    // ======= CONFIG =======
    const SECRET = "sweetheart";

    // couple photos (already in your repo as assets/p1.jpg ... assets/p5.jpg)
    const COUPLE_PHOTOS = [
      { src: "assets/p2.jpg", r: "-6deg" },
      { src: "assets/p5.jpg", r: "7deg" },
      { src: "assets/p3.jpg", r: "-8deg" },
      { src: "assets/p4.jpg", r: "6deg" },
      { src: "assets/p1.jpg", r: "-7deg" },
    ];

    // cat photos (add these into /assets/ as c1.jpg c2.jpg c3.jpg)
    // If you haven't uploaded them yet, do that and name them exactly like below.
    const CAT_PHOTOS = [
      { src: "assets/c1.jpg", r: "-6deg" },
      { src: "assets/c2.jpg", r: "7deg" },
      { src: "assets/c3.jpg", r: "-5deg" },
    ];

    // ======= ELEMENTS =======
    const envelope = document.getElementById("envelope");
    const letter = document.getElementById("letter");
    const letterTitle = document.getElementById("letterTitle");
    const letterButtons = document.getElementById("letterButtons");
    const acceptBtn = document.getElementById("acceptBtn");
    const rejectBtn = document.getElementById("rejectBtn");

    const controls = document.getElementById("controls");
    const hint = document.getElementById("hint");
    const codeInput = document.getElementById("codeInput");
    const unlockBtn = document.getElementById("unlockBtn");
    const resetBtn = document.getElementById("resetBtn");
    const errorText = document.getElementById("errorText");

    const photosLeft = document.getElementById("photosLeft");
    const photosRight = document.getElementById("photosRight");
    const confettiLayer = document.getElementById("confettiLayer");

    // ======= STATE =======
    let unlocked = false;
    let outcome = "none"; // "none" | "accepted" | "rejected"
    let rejectDodges = 0;
    let rejectDodgingEnabled = true;

    // ======= HELPERS =======
    function norm(s){
      return (s || "").trim().toLowerCase();
    }

    function clearPhotos(){
      photosLeft.innerHTML = "";
      photosRight.innerHTML = "";
    }

    function renderPhotos(list){
      clearPhotos();

      // Split into left/right roughly like your screenshot:
      // left gets first 2, right gets rest
      const left = list.slice(0,2);
      const right = list.slice(2);

      for(const p of left){
        const card = document.createElement("div");
        card.className = "photo show";
        card.style.setProperty("--r", p.r);
        const img = document.createElement("img");
        img.src = p.src;
        img.alt = "";
        card.appendChild(img);
        photosLeft.appendChild(card);
      }
      for(const p of right){
        const card = document.createElement("div");
        card.className = "photo show";
        card.style.setProperty("--r", p.r);
        const img = document.createElement("img");
        img.src = p.src;
        img.alt = "";
        card.appendChild(img);
        photosRight.appendChild(card);
      }
    }

    function startConfetti(){
      // hearts + tennis balls
      const symbols = ["üíó","üíñ","üíò","üíû","üéæ","üéæ","üéæ"];
      const count = 46;

      for(let i=0;i<count;i++){
        const el = document.createElement("div");
        el.className = "confetti";
        el.textContent = symbols[Math.floor(Math.random()*symbols.length)];

        const x = Math.random()*100; // vw
        const dur = 2.6 + Math.random()*1.8;
        const delay = Math.random()*0.25;

        el.style.left = x + "vw";
        el.style.animationDuration = dur + "s";
        el.style.animationDelay = delay + "s";

        const size = 18 + Math.floor(Math.random()*18);
        el.style.fontSize = size + "px";

        confettiLayer.appendChild(el);

        // cleanup
        setTimeout(()=> el.remove(), (dur + delay) * 1000 + 400);
      }
    }

    function openEnvelope(){
      envelope.classList.add("open");
      letter.classList.add("wide");
      startConfetti();
    }

    function closeEnvelope(){
      envelope.classList.remove("open");
      letter.classList.remove("wide");
    }

    function hideCodeSection(){
      hint.classList.add("hidden");
      document.querySelector(".input-row").classList.add("hidden");
      errorText.classList.add("hidden");
    }

    function showCodeSection(){
      hint.classList.remove("hidden");
      document.querySelector(".input-row").classList.remove("hidden");
      errorText.classList.remove("hidden");
    }

    function setLetterInitial(){
      letterTitle.innerHTML = "congratulations!<br>you<br>have won a certificate<br>for 1000 kissesüíã";
      letterButtons.classList.remove("hidden");
      acceptBtn.classList.remove("hidden");
      rejectBtn.classList.remove("hidden");
    }

    function setLetterAccepted(){
      letterTitle.innerHTML = "yayyy, contact your gf<br>for activation :)<br>happy valentines ü´∂";
      // keep buttons visible or not? (your spec: after accept, no need for code line; buttons can stay or not)
      // We'll keep them but disable accept (so it doesn't re-trigger), reject still exists but won't change outcome.
      acceptBtn.disabled = true;
      rejectBtn.disabled = true;
    }

    function setLetterRejected(){
      letterTitle.textContent = "think again";
      // keep buttons visible so he can still accept afterward if you want:
      acceptBtn.disabled = false;
      rejectBtn.disabled = false;
    }

    // ======= REJECT BUTTON "MOVE" BUT STILL CLICKABLE =======
    function dodgeReject(){
      if(!rejectDodgingEnabled) return;

      // dodge only a few times, then stop so it becomes clickable
      rejectDodges++;
      if(rejectDodges >= 5){
        rejectDodgingEnabled = false;
        return;
      }

      const max = 42; // px
      const dx = (Math.random()*2 - 1) * max;
      const dy = (Math.random()*2 - 1) * (max*0.55);

      rejectBtn.style.transform = `translate(${dx}px, ${dy}px)`;
      // softly return after a moment
      setTimeout(()=>{
        rejectBtn.style.transform = `translate(0px, 0px)`;
      }, 380);
    }

    // ======= ACTIONS =======
    function tryUnlock(){
      if(unlocked) return;

      const val = norm(codeInput.value);
      if(val === SECRET){
        unlocked = true;
        errorText.textContent = "";
        unlockBtn.disabled = true;
        codeInput.disabled = true;

        openEnvelope();
        // show the initial letter with buttons (only now!)
        setLetterInitial();

        // still keep the code line until accept/reject happens (your earlier spec)
        // Do NOT show any photos yet
        clearPhotos();
      } else {
        errorText.textContent = "wrong code ‚Äî try again";
      }
    }

    function onAccept(){
      if(!unlocked) return;

      outcome = "accepted";
      hideCodeSection();
      setLetterAccepted();
      renderPhotos(COUPLE_PHOTOS);
    }

    function onReject(){
      if(!unlocked) return;

      outcome = "rejected";
      hideCodeSection();
      setLetterRejected();
      renderPhotos(CAT_PHOTOS);
    }

    function resetAll(){
      unlocked = false;
      outcome = "none";
      rejectDodges = 0;
      rejectDodgingEnabled = true;
      acceptBtn.disabled = false;
      rejectBtn.disabled = false;
      rejectBtn.style.transform = "translate(0px,0px)";

      closeEnvelope();
      clearPhotos();

      setLetterInitial();
      // but keep letter hidden until unlocked (envelope closed => letter hidden)
      showCodeSection();
      errorText.textContent = "";

      codeInput.value = "";
      codeInput.disabled = false;
      unlockBtn.disabled = false;

      // focus input for convenience
      setTimeout(()=> codeInput.focus(), 80);
    }

    // ======= WIRE UP =======
    unlockBtn.addEventListener("click", tryUnlock);
    codeInput.addEventListener("keydown", (e)=>{
      if(e.key === "Enter") tryUnlock();
    });

    acceptBtn.addEventListener("click", onAccept);

    // reject dodges on hover/touch move but still becomes clickable after a few dodges
    rejectBtn.addEventListener("mouseenter", dodgeReject);
    rejectBtn.addEventListener("mousemove", dodgeReject);
    rejectBtn.addEventListener("click", onReject);

    resetBtn.addEventListener("click", resetAll);

    // Initial state (closed envelope, no letter interaction)
    // Make sure buttons can't be used until unlocked (even if someone tabs)
    acceptBtn.addEventListener("mousedown", (e)=>{ if(!unlocked) e.preventDefault(); });
    rejectBtn.addEventListener("mousedown", (e)=>{ if(!unlocked) e.preventDefault(); });

    // start clean
    resetAll();
  </script>
</body>
</html>


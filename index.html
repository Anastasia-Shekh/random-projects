<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ðŸ’Œ</title>

  <style>
    :root{
      --bg:#fbd1e6;
      --bg2:#fff4fb;
      --ink:#2b2b2b;
      --accent:#ff3c97;
      --accent2:#ff7bbb;
      --blue:#2f63ff;
      --paper:#fff7fb;
      --shadow: rgba(0,0,0,.18);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      justify-content:center;
      background:
        radial-gradient(1200px 700px at 50% 10%, var(--bg2), var(--bg));
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--ink);
      overflow-x:hidden;
    }

    /* layout wrapper */
    .page{
      width:min(1200px, 96vw);
      padding:40px 12px 60px;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:26px;
    }

    /* SIDE PHOTO COLUMNS (hidden until needed) */
    .side-photos{
      position:fixed;
      top:110px;
      left:0;
      right:0;
      display:none;
      pointer-events:none;
      z-index:2;
    }
    .col{
      position:absolute;
      display:flex;
      flex-direction:column;
      gap:16px;
    }
    .col.left{ left:45px; }
    .col.right{ right:45px; }

    .polaroid{
      width:240px;
      height:310px;
      background:#fff;
      border-radius:22px;
      padding:10px;
      box-shadow: 0 18px 35px rgba(0,0,0,.25);
      border:6px solid rgba(255,255,255,.9);
      overflow:hidden;
      transform: rotate(-6deg);
    }
    .col.right .polaroid{ transform: rotate(6deg); }
    .col.left .polaroid:nth-child(2){ transform: rotate(4deg); }
    .col.right .polaroid:nth-child(2){ transform: rotate(-5deg); }
    .col.right .polaroid:nth-child(3){ transform: rotate(7deg); }

    .polaroid img{
      width:100%;
      height:100%;
      object-fit:cover;
      border-radius:14px;
      display:block;
    }

    /* ENVELOPE BLOCK */
    .stage{
      position:relative;
      width:620px;
      height:520px;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:3;
      filter: drop-shadow(0 30px 40px rgba(0,0,0,.18));
    }

    .envelope{
      position:relative;
      width:560px;
      height:360px;
      border-radius:26px;
      background: linear-gradient(145deg, #ff4aa2, #d92b7a);
      box-shadow: 0 20px 40px rgba(0,0,0,.22);
      overflow:visible;
    }

    /* bottom pocket (makes it look like an envelope) */
    .pocket{
      position:absolute;
      inset:0;
      border-radius:26px;
      overflow:hidden;
    }
    .pocket:before{
      content:"";
      position:absolute;
      left:0; right:0;
      bottom:0;
      height:62%;
      background: rgba(0,0,0,.08);
      clip-path: polygon(0% 100%, 50% 35%, 100% 100%, 100% 100%, 0% 100%);
    }
    .pocket:after{
      content:"";
      position:absolute;
      left:0; right:0;
      bottom:-2px;
      height:66%;
      background: rgba(255,255,255,.12);
      clip-path: polygon(0% 100%, 50% 30%, 100% 100%, 100% 100%, 0% 100%);
      mix-blend-mode: soft-light;
    }

    /* left & right folds */
    .fold-left, .fold-right{
      position:absolute;
      top:0;
      width:50%;
      height:100%;
      opacity:.22;
      background:#000;
    }
    .fold-left{
      left:-1px;
      clip-path: polygon(0 0, 100% 50%, 0 100%);
      opacity:.10;
    }
    .fold-right{
      right:-1px;
      clip-path: polygon(100% 0, 0 50%, 100% 100%);
      opacity:.08;
    }

    /* top flap */
    .flap{
      position:absolute;
      left:0;
      top:-200px;
      width:0;height:0;
      border-left:280px solid transparent;
      border-right:280px solid transparent;
      border-bottom:200px solid #ff7bbb;
      transform-origin: bottom center;
      transform: rotateX(0deg);
      transition: transform .8s ease;
      filter: drop-shadow(0 14px 18px rgba(0,0,0,.15));
    }
    .envelope.open .flap{
      transform: rotateX(180deg);
    }

    /* letter */
    .letter{
      position:absolute;
      left:50%;
      transform: translateX(-50%);
      top:120px;
      width:460px;
      min-height:240px;
      background: var(--paper);
      border-radius:22px;
      border:5px solid var(--blue);
      box-shadow: 0 18px 38px rgba(0,0,0,.22);
      padding:26px 24px 22px;
      display:flex;
      flex-direction:column;
      gap:16px;
      align-items:center;
      text-align:center;
      transition: all .65s ease;
      z-index:5;
      pointer-events:none; /* locked until unlocked */
      opacity:.0;
      transform: translateX(-50%) translateY(30px);
    }

    .envelope.open .letter{
      top:-40px;
      width:640px; /* wider when opened */
      opacity:1;
      transform: translateX(-50%) translateY(0px);
      pointer-events:auto;
    }

    .title{
      margin:0;
      font-size:42px;
      line-height:1.08;
      color:#7f2f55;
      letter-spacing:-.02em;
      font-weight:800;
    }

    .btnrow{
      display:flex;
      gap:16px;
      justify-content:center;
      margin-top:6px;
      flex-wrap:wrap;
      position:relative;
    }

    button{
      border:none;
      border-radius:999px;
      padding:14px 28px;
      font-size:18px;
      font-weight:700;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
      user-select:none;
    }
    button:active{ transform: translateY(1px) scale(.99); }
    .btn-accept{ background: var(--accent); color:#fff; box-shadow: 0 10px 22px rgba(255,60,151,.35); }
    .btn-reject{ background: #f1c6d8; color:#7f2f55; border:2px solid var(--blue); box-shadow: 0 8px 18px rgba(0,0,0,.12); }

    /* CODE SECTION */
    .code{
      width:min(820px, 92vw);
      display:flex;
      flex-direction:column;
      gap:16px;
      align-items:center;
      text-align:center;
      z-index:4;
    }

    .quote{
      margin:0;
      font-size:22px;
      line-height:1.35;
      color:#1f1f1f;
    }
    .quote i{ font-style:italic; }

    .code-row{
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      justify-content:center;
      align-items:center;
    }

    input{
      width:min(520px, 86vw);
      padding:16px 18px;
      border-radius:18px;
      border:3px solid #ff6fb3;
      background:#fff7fb;
      font-size:20px;
      outline:none;
    }
    input:focus{
      border-color: var(--accent);
      box-shadow: 0 0 0 6px rgba(255,60,151,.14);
    }
    .btn-unlock{ background: var(--accent); color:#fff; padding:16px 30px; font-size:20px; }

    .btn-reset{
      margin-top:18px;
      background:#ffe9f4;
      color:#7f2f55;
      border:3px solid #ffb7d8;
      padding:16px 34px;
      font-size:20px;
      box-shadow: 0 14px 26px rgba(0,0,0,.12);
    }

    /* CONFETTI */
    .confetti{
      position:fixed;
      top:-30px;
      font-size:30px;
      z-index:10;
      animation: fall linear forwards;
      pointer-events:none;
      filter: drop-shadow(0 8px 10px rgba(0,0,0,.12));
    }
    @keyframes fall{
      to{ transform: translateY(110vh) rotate(360deg); opacity:.95; }
    }

    /* responsive */
    @media (max-width: 980px){
      .side-photos{ display:none !important; }
      .stage{ width:96vw; height:520px; }
      .envelope{ width:92vw; max-width:560px; }
      .flap{
        border-left: calc(min(280px, 46vw)) solid transparent;
        border-right: calc(min(280px, 46vw)) solid transparent;
        border-bottom: 200px solid #ff7bbb;
      }
    }
  </style>
</head>

<body>
  <div class="page">

    <!-- SIDE PHOTOS (love) -->
    <div class="side-photos" id="lovePhotos">
      <div class="col left">
        <div class="polaroid"><img src="assets/p1.jpg" alt=""></div>
        <div class="polaroid"><img src="assets/p3.jpg" alt=""></div>
      </div>
      <div class="col right">
        <div class="polaroid"><img src="assets/p5.jpg" alt=""></div>
        <div class="polaroid"><img src="assets/p2.jpg" alt=""></div>
        <div class="polaroid"><img src="assets/p4.jpg" alt=""></div>
      </div>
    </div>

    <!-- SIDE PHOTOS (cats) -->
    <div class="side-photos" id="catPhotos">
      <div class="col left">
        <div class="polaroid"><img src="assets/cat1.jpg" alt=""></div>
        <div class="polaroid"><img src="assets/cat2.jpg" alt=""></div>
      </div>
      <div class="col right">
        <div class="polaroid"><img src="assets/cat3.jpg" alt=""></div>
      </div>
    </div>

    <!-- ENVELOPE STAGE -->
    <div class="stage">
      <div class="envelope" id="envelope" aria-label="envelope">
        <div class="flap"></div>

        <div class="pocket"></div>
        <div class="fold-left"></div>
        <div class="fold-right"></div>

        <div class="letter" id="letter">
          <h1 class="title" id="letterTitle">
            congratulations! you have won a certificate for 1000 kisses ðŸ’‹
          </h1>

          <div class="btnrow" id="btnRow">
            <button class="btn-accept" id="acceptBtn" type="button">Accept</button>
            <button class="btn-reject" id="rejectBtn" type="button">Reject</button>
          </div>
        </div>
      </div>
    </div>

    <!-- CODE SECTION (shown first, hidden after accept/reject) -->
    <div class="code" id="codeSection">
      <p class="quote">
        <i>"i am sinkinggg... u should know the code.</i><br>
        Hint: it's a cute nickname but you'd think i'm a sarcastic grandma if i say it, 10 letters"
      </p>

      <div class="code-row">
        <!-- visible letters while typing -->
        <input id="codeInput" type="text" autocomplete="off" spellcheck="false" />
        <button class="btn-unlock" id="unlockBtn" type="button">Unlock</button>
      </div>

      <button class="btn-reset" id="resetBtn" type="button">Reset</button>
    </div>

  </div>

  <script>
    const envelope = document.getElementById("envelope");
    const codeSection = document.getElementById("codeSection");
    const codeInput = document.getElementById("codeInput");
    const unlockBtn = document.getElementById("unlockBtn");
    const resetBtn = document.getElementById("resetBtn");

    const acceptBtn = document.getElementById("acceptBtn");
    const rejectBtn = document.getElementById("rejectBtn");
    const letterTitle = document.getElementById("letterTitle");
    const btnRow = document.getElementById("btnRow");

    const lovePhotos = document.getElementById("lovePhotos");
    const catPhotos  = document.getElementById("catPhotos");

    let unlocked = false;
    let rejectMoves = 0;

    function hardReset(){
      unlocked = false;
      rejectMoves = 0;

      envelope.classList.remove("open");
      codeSection.style.display = "flex";

      lovePhotos.style.display = "none";
      catPhotos.style.display = "none";

      letterTitle.textContent = "congratulations! you have won a certificate for 1000 kisses ðŸ’‹";
      btnRow.innerHTML = `
        <button class="btn-accept" id="acceptBtn" type="button">Accept</button>
        <button class="btn-reject" id="rejectBtn" type="button">Reject</button>
      `;

      // re-bind buttons after innerHTML reset
      bindButtons();

      codeInput.value = "";
      codeInput.focus();
    }

    function bindButtons(){
      const a = document.getElementById("acceptBtn");
      const r = document.getElementById("rejectBtn");

      a.addEventListener("click", () => {
        if(!unlocked) return; // cannot accept without code
        doAccept();
      });

      r.addEventListener("mouseenter", () => {
        if(!unlocked) return;
        dodgeReject(r);
      });

      r.addEventListener("click", () => {
        if(!unlocked) return;
        doReject();
      });
    }

    function dodgeReject(btn){
      // playful but still clickable: only dodge a few times and not too far
      if (rejectMoves >= 5) return;

      const jitterX = (Math.random() * 120) - 60; // -60..60
      const jitterY = (Math.random() * 50) - 25;  // -25..25

      btn.style.position = "relative";
      btn.style.left = jitterX + "px";
      btn.style.top  = jitterY + "px";

      rejectMoves++;
      // after a short time, come back closer so itâ€™s still catchable
      setTimeout(() => {
        btn.style.left = "0px";
        btn.style.top  = "0px";
      }, 280);
    }

    function unlock(){
      const val = (codeInput.value || "").trim().toLowerCase();
      if(val === "sweetheart"){
        unlocked = true;
        envelope.classList.add("open");
        // keep code section visible until accept/reject is chosen (as you had)
      } else {
        alert("wrong code ðŸ’”");
      }
    }

    function doAccept(){
      // hide code section after decision
      codeSection.style.display = "none";

      // confetti hearts + tennis balls
      burstConfetti(60);

      letterTitle.textContent = "yayyy, contact your gf for activation :) happy valentines ðŸ«¶";
      // remove buttons after accept (optional â€” clean)
      btnRow.innerHTML = "";

      // show couple photos
      lovePhotos.style.display = "block";
      catPhotos.style.display = "none";
    }

    function doReject(){
      codeSection.style.display = "none";

      letterTitle.textContent = "think againnn";
      // keep buttons off after reject (clean)
      btnRow.innerHTML = "";

      lovePhotos.style.display = "none";
      catPhotos.style.display = "block";
    }

    function burstConfetti(count){
      const emojis = ["ðŸ’–","ðŸ’—","ðŸ’ž","ðŸŽ¾","ðŸ’˜","ðŸŽ¾"];
      for(let i=0;i<count;i++){
        const el = document.createElement("div");
        el.className = "confetti";
        el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
        el.style.left = Math.random()*100 + "vw";
        el.style.animationDuration = (Math.random()*1.7 + 2.2) + "s";
        el.style.transform = `translateY(0) rotate(${Math.random()*180}deg)`;
        el.style.opacity = (Math.random()*0.35 + 0.65).toFixed(2);
        document.body.appendChild(el);
        setTimeout(()=> el.remove(), 4200);
      }
    }

    // bindings
    unlockBtn.addEventListener("click", unlock);
    resetBtn.addEventListener("click", hardReset);

    codeInput.addEventListener("keydown", (e) => {
      if(e.key === "Enter") unlock();
    });

    // initial bind
    bindButtons();
    codeInput.focus();
  </script>
</body>
</html>
